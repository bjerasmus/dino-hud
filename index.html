<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DinoDawgs FPS HUD</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
<style>
body {
  margin: 0;
  font-family: 'Orbitron', sans-serif;
  color: #00ffff;
  background: transparent;
  overflow: hidden;
}

/* Main HUD container */
#hud {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 320px;
  padding: 10px;
  background: rgba(0,0,0,0.25);
  border: 2px solid #00ffff;
  border-radius: 10px;
  box-shadow: 0 0 15px #00ffff;
}

/* Segmented bars */
.bar-container {
  width: 100%;
  height: 22px;
  background: rgba(50,50,50,0.5);
  border: 1px solid #00ffff;
  border-radius: 4px;
  margin-bottom: 6px;
  display: flex;
  overflow: hidden;
}

.bar {
  height: 100%;
  transition: width 0.3s;
  box-shadow: 0 0 8px #00ffff inset;
}

/* Health bar colors */
#health-bar {
  background: linear-gradient(to right, limegreen, #00ff80);
}

#armor-bar {
  background: linear-gradient(to right, dodgerblue, #00cfff);
}

/* Low health flash */
.low-health {
  animation: flash-red 1s infinite;
}

@keyframes flash-red {
  0%, 100% { background: red; }
  50% { background: darkred; }
}

/* Stats panel */
#stats {
  margin-top: 8px;
  background: rgba(0,0,0,0.4);
  padding: 6px;
  border-radius: 6px;
  border: 1px solid #00ffff;
  box-shadow: 0 0 10px #00ffff inset;
}

#kills, #deaths, #kdr, #squad {
  margin: 3px 0;
  font-size: 16px;
  text-shadow: 0 0 6px #00ffff;
}

/* Weapon + Ammo display */
#weapon {
  display: flex;
  align-items: center;
  margin-top: 10px;
  background: rgba(0,0,0,0.4);
  padding: 4px 6px;
  border-radius: 6px;
  border: 1px solid #00ffff;
  box-shadow: 0 0 10px #00ffff inset;
}

#weapon img {
  width: 50px;
  height: 50px;
  margin-right: 10px;
  border: 1px solid #00ffff;
  border-radius: 4px;
  box-shadow: 0 0 8px #00ffff;
}

#ammo {
  font-size: 20px;
  text-shadow: 0 0 8px #00ffff;
}

/* Power-up display */
#powerups {
  margin-top: 10px;
}

.powerup {
  display: inline-block;
  background: #ff0;
  color: #000;
  padding: 2px 6px;
  margin-right: 5px;
  border-radius: 4px;
  font-weight: bold;
  text-shadow: 0 0 4px #ff0;
}

/* Ammo warning */
.low-ammo {
  animation: flash-yellow 1s infinite;
}

@keyframes flash-yellow {
  0%, 100% { background: yellow; }
  50% { background: orange; }
}

/* Mini-map container */
#minimap-container {
  position: fixed;
  top: 10px;
  right: 10px;
  width: 180px;
  height: 180px;
  z-index: 100;
  background: rgba(0,0,0,0.25);
  border: 2px solid #00ffff;
  border-radius: 10px;
  padding: 4px;
  box-shadow: 0 0 10px #00ffff;
  overflow: hidden;
}

#minimap {
  width: 100%;
  height: 100%;
}

/* Buildings */
.minimap-building {
  fill: #00ffff;
  stroke: #00ffff;
  stroke-width: 1;
  opacity: 0.6;
}

/* Player / other players */
.minimap-player {
  fill: #ff0;
  filter: drop-shadow(0 0 4px #ff0);
  transition: cx 0.1s, cy 0.1s;
}

/* Squad members */
.minimap-squad {
  fill: #0f0;
  filter: drop-shadow(0 0 4px #0f0);
  transition: cx 0.1s, cy 0.1s;
}

/* Pulse animation for moving entities */
@keyframes pulse {
  0% { r: 4; opacity: 0.6; }
  50% { r: 6; opacity: 1; }
  100% { r: 4; opacity: 0.6; }
}

.pulse {
  animation: pulse 1s infinite;
}

/* Player direction arrow */
#player-arrow {
  fill: #ff0;
  stroke: #ff0;
  stroke-width: 1;
}
</style>
</head>
<body>

<!-- HUD -->
<div id="hud">
  <div class="bar-container">
    <div id="health-bar" class="bar"></div>
  </div>
  <div class="bar-container">
    <div id="armor-bar" class="bar"></div>
  </div>

  <div id="stats">
    <div id="squad">Squad: Alpha</div>
    <div id="kills">Kills: 0</div>
    <div id="deaths">Deaths: 0</div>
    <div id="kdr">K/D: 0.00</div>
  </div>

  <div id="weapon">
    <img id="weapon-icon" src="rifle.png" alt="Weapon">
    <span id="ammo">30</span>
  </div>

  <div id="powerups">
    <div class="powerup" id="boost">âš¡ 5s</div>
  </div>
</div>

<!-- Mini-map -->
<div id="minimap-container">
  <svg id="minimap" viewBox="-350 -250 300 300">
    <rect x="-330" y="-220" width="240" height="260" fill="none" stroke="rgba(0, 255, 255, 0.5)" stroke-width="2"/>
    <!-- Buildings -->
    <rect class="minimap-building" x="-190" y="-100" width="30" height="30"/>
    <rect class="minimap-building" x="-165" y="-95" width="20" height="25"/>
    <rect class="minimap-building" x="-250" y="-130" width="35" height="35"/>
    <rect class="minimap-building" x="-245" y="-90" width="25" height="20"/>
    <rect class="minimap-building" x="-160" y="-70" width="30" height="28"/>
    <rect class="minimap-building" x="-155" y="-40" width="22" height="22"/>
    <rect class="minimap-building" x="-210" y="-180" width="28" height="28"/>
    <rect class="minimap-building" x="-195" y="-30" width="25" height="25"/>
    <!-- Player -->
    <circle id="player-dot" class="minimap-player" cx="-180" cy="-90" r="5"/>
    <polygon id="player-arrow" points="-180,-90 -185,-85 -175,-85"/>
  </svg>
</div>

<script>
// --- HUD Update Functions ---
function updateHealth(current, max) {
  const bar = document.getElementById('health-bar');
  const percent = (current / max) * 100;
  bar.style.width = percent + '%';
  if(percent < 25) bar.classList.add('low-health');
  else bar.classList.remove('low-health');
}

function updateArmor(current, max) {
  const bar = document.getElementById('armor-bar');
  bar.style.width = (current / max * 100) + '%';
}

function updateKills(kills) {
  document.getElementById('kills').innerText = 'Kills: ' + kills;
  updateKDR();
}

function updateDeaths(deaths) {
  document.getElementById('deaths').innerText = 'Deaths: ' + deaths;
  updateKDR();
}

function updateKDR() {
  const kills = parseInt(document.getElementById('kills').innerText.split(': ')[1]);
  const deaths = parseInt(document.getElementById('deaths').innerText.split(': ')[1]);
  const kdr = deaths === 0 ? kills : (kills / deaths).toFixed(2);
  document.getElementById('kdr').innerText = 'K/D: ' + kdr;
}

function updateWeapon(name, icon, ammo) {
  const weaponIcon = document.getElementById('weapon-icon');
  const ammoElem = document.getElementById('ammo');
  weaponIcon.src = icon;
  ammoElem.innerText = ammo;
  if(ammo < 5) ammoElem.classList.add('low-ammo');
  else ammoElem.classList.remove('low-ammo');
}

function updateSquad(name) {
  document.getElementById('squad').innerText = 'Squad: ' + name;
}

function updatePowerup(id, label, seconds) {
  const elem = document.getElementById(id);
  elem.innerText = label + ' ' + seconds + 's';
}

// --- Mini-map Functions ---
const minimap = document.getElementById('minimap');
const playerDot = document.getElementById('player-dot');
const playerArrow = document.getElementById('player-arrow');
let entityDots = {}; // {id: SVGCircleElement}

function updateMinimap(data) {
  if(data.player) {
    const {x, y, rotation} = data.player;
    playerDot.setAttribute('cx', x);
    playerDot.setAttribute('cy', y);
    // Rotate arrow
    const size = 10;
    const rad = rotation * (Math.PI/180);
    const px = x;
    const py = y;
    const p1x = px + size * Math.sin(rad);
    const p1y = py - size * Math.cos(rad);
    const p2x = px - size/2 * Math.cos(rad);
    const p2y = py - size/2 * Math.sin(rad);
    const p3x = px + size/2 * Math.cos(rad);
    const p3y = py + size/2 * Math.sin(rad);
    playerArrow.setAttribute('points', `${p1x},${p1y} ${p2x},${p2y} ${p3x},${p3y}`);
  }
  if(data.entities) {
    data.entities.forEach(e => {
      let dot = entityDots[e.id];
      if(!dot) {
        dot = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        dot.setAttribute('r', 5);
        dot.classList.add(e.squad ? 'minimap-squad' : 'minimap-player', 'pulse');
        minimap.appendChild(dot);
        entityDots[e.id] = dot;
      }
      dot.setAttribute('cx', e.x);
      dot.setAttribute('cy', e.y);
    });
  }
}

// --- Listen for messages ---
window.addEventListener('message', (event) => {
  const data = event.data;
  if(data.health !== undefined && data.maxHealth !== undefined) updateHealth(data.health, data.maxHealth);
  if(data.armor !== undefined && data.maxArmor !== undefined) updateArmor(data.armor, data.maxArmor);
  if(data.kills !== undefined) updateKills(data.kills);
  if(data.deaths !== undefined) updateDeaths(data.deaths);
  if(data.weapon !== undefined) updateWeapon(data.weapon.name, data.weapon.icon, data.weapon.ammo);
  if(data.squad !== undefined) updateSquad(data.squad);
  if(data.powerups !== undefined) data.powerups.forEach(p => updatePowerup(p.id, p.label, p.seconds));
  if(data.minimap) updateMinimap(data.minimap);
});
</script>
</body>
</html>
